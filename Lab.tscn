[gd_scene load_steps=14 format=2]

[ext_resource path="res://gameplay/crates/obj_crate_nitro.tscn" type="PackedScene" id=1]
[ext_resource path="res://gameplay/obj_item_aku.tscn" type="PackedScene" id=2]
[ext_resource path="res://gameplay/obj_life.tscn" type="PackedScene" id=3]
[ext_resource path="res://gameplay/obj_Character.tscn" type="PackedScene" id=4]
[ext_resource path="res://gameplay/crates/obj_crate_tnt.tscn" type="PackedScene" id=5]
[ext_resource path="res://Debug/DebugText.tscn" type="PackedScene" id=6]
[ext_resource path="res://gameplay/crates/obj_crate_bounce.tscn" type="PackedScene" id=7]
[ext_resource path="res://scripts/gameplay/GameplayCamera.gd" type="Script" id=8]
[ext_resource path="res://textures/lv_toadvillage/tex_ground.png" type="Texture" id=9]

[sub_resource type="SpatialMaterial" id=1]
albedo_texture = ExtResource( 9 )
uv1_scale = Vector3( 20, 20, 1 )

[sub_resource type="PlaneMesh" id=2]
material = SubResource( 1 )
size = Vector2( 3, 3 )

[sub_resource type="ConcavePolygonShape" id=3]
data = PoolVector3Array( 1.5, 0, 1.5, -1.5, 0, 1.5, 1.5, 0, -1.5, -1.5, 0, 1.5, -1.5, 0, -1.5, 1.5, 0, -1.5 )

[sub_resource type="GDScript" id=4]
script/source = "extends Crate

var health:int = 5

func decrease_health():
	health -= 1
	character.iventory.add_wumpa(2)
	$Anim.play(\"bounce\")
	print(\"bounce\")
	$sfx_bounce.play()
	$sfx_bounce.pitch_scale += 0.02
	if (health <= 0):
		_on_Attacked()

func _on_Attacked():
	$model.visible = false
	$CollisionShape.disabled = true
	$Particle.emitting = true
	$sfx_crate.play()
	yield(get_tree().create_timer($sfx_crate.stream.get_length(),false),\"timeout\")
	queue_free()
	
func _on_Jumped():
	print(\"jumped\")
	decrease_health()
	

"

[node name="Lab" type="Spatial" groups=[
"scene",
]]

[node name="DebugText" parent="." instance=ExtResource( 6 )]

[node name="Button2" type="Button" parent="."]
margin_left = 213.0
margin_top = 4.0
margin_right = 281.0
margin_bottom = 33.0
focus_mode = 0
enabled_focus_mode = 0
text = "Respawn"
__meta__ = {
"_edit_use_anchors_": false
}

[node name="Button3" type="Button" parent="."]
margin_left = 213.0
margin_top = 33.0
margin_right = 285.0
margin_bottom = 62.0
focus_mode = 0
enabled_focus_mode = 0
text = "Decrease"
__meta__ = {
"_edit_use_anchors_": false
}

[node name="Camera" type="Camera" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -3.21982, 3.69873, 8.73469 )
size = 7.79504
script = ExtResource( 8 )

[node name="obj_Character" parent="." instance=ExtResource( 4 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -4.35639, 0.54602, 2.58163 )
collision_mask = 190

[node name="Level" type="Spatial" parent="."]

[node name="MeshInstance" type="MeshInstance" parent="Level"]
transform = Transform( 9.13981, 0, 0, 0, 9.13981, 0, 0, 0, 9.13981, -0.00161552, 0.0171592, 0.0097127 )
mesh = SubResource( 2 )
material/0 = null

[node name="StaticBody" type="StaticBody" parent="Level/MeshInstance"]
collision_layer = 16

[node name="CollisionShape" type="CollisionShape" parent="Level/MeshInstance/StaticBody"]
shape = SubResource( 3 )

[node name="obj_life" parent="Level" instance=ExtResource( 3 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -0.236221, 0.431953, -1.15292 )

[node name="obj_item_aku" parent="Level" instance=ExtResource( 2 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.319266, -2.75605 )

[node name="obj_crate_tnt" parent="Level" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -0.882291, 0.21716, 0.213712 )

[node name="obj_crate_tnt2" parent="Level" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -0.614008, 0.21716, 3.88778 )
affectedByExplosion = false

[node name="obj_crate_tnt3" parent="Level" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -0.698083, 0.217159, 1.86545 )

[node name="obj_crate_nitro" parent="Level" instance=ExtResource( 1 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -2.4084, 0.217159, -1.93808 )

[node name="obj_crate_nitro2" parent="Level" instance=ExtResource( 1 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -2.66084, 0.217159, 1.41688 )

[node name="obj_crate_bounce" parent="Level" instance=ExtResource( 7 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -2.00927, 0.217159, 2.994 )
script = SubResource( 4 )

[node name="obj_crate_bounce2" parent="Level" instance=ExtResource( 7 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -1.80312, 4.13513, 2.71289 )
startGravity = false

[node name="obj_crate_tnt4" parent="Level" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -4.02411, 0.217159, -0.603093 )

[node name="obj_crate_tnt5" parent="Level" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -5, 0, -1 )

[node name="obj_crate_tnt6" parent="Level" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -6, 0, 0 )

[node name="obj_crate_tnt7" parent="Level" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -7, 0, 1 )

[node name="obj_crate_tnt8" parent="Level" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -7, 0, 0 )

[node name="obj_crate_tnt9" parent="Level" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -6, 0, -1 )

[node name="obj_crate_tnt10" parent="Level" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -6, 1, 0 )

[node name="obj_crate_tnt11" parent="Level" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -6, 0, 5 )

[node name="obj_crate_tnt12" parent="Level" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -6, 1, 5 )

[node name="obj_crate_tnt13" parent="Level" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -7, 0, 4 )

[node name="obj_crate_tnt14" parent="Level" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -5, 0, 5 )

[node name="obj_crate_tnt15" parent="Level" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -5, 1, 5 )

[node name="obj_crate_tnt16" parent="Level" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -4.93341, 2.20875, 5.32771 )

[node name="obj_crate_tnt17" parent="Level" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -2, 0, 5 )
[connection signal="pressed" from="Button2" to="obj_Character" method="_on_Button2_pressed"]
[connection signal="pressed" from="Button3" to="obj_Character" method="_on_Button3_pressed"]

[editable path="DebugText"]
