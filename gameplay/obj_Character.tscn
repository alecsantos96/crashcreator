[gd_scene load_steps=41 format=2]

[ext_resource path="res://scripts/gameplay/character.gd" type="Script" id=1]
[ext_resource path="res://models/characters/Crash.dae" type="PackedScene" id=2]
[ext_resource path="res://scripts/gameplay/CharacterAnim.gd" type="Script" id=3]
[ext_resource path="res://models/characters/Crash/twist.tscn" type="PackedScene" id=9]

[sub_resource type="BoxShape" id=1]
extents = Vector3( 0.415174, 0.761578, 0.264996 )

[sub_resource type="AnimationNodeAnimation" id=2]
animation = "Fall"

[sub_resource type="AnimationNodeAnimation" id=3]
animation = "FallGround"

[sub_resource type="AnimationNodeTimeScale" id=4]

[sub_resource type="AnimationNodeBlendTree" id=5]
graph_offset = Vector2( -111, 111 )
nodes/Animation/node = SubResource( 3 )
nodes/Animation/position = Vector2( -40, 160 )
nodes/fallground-speed/node = SubResource( 4 )
nodes/fallground-speed/position = Vector2( 140, 180 )
nodes/output/position = Vector2( 360, 140 )
node_connections = [ "output", 0, "fallground-speed", "fallground-speed", 0, "Animation" ]

[sub_resource type="AnimationNodeAnimation" id=6]
animation = "Jump"

[sub_resource type="AnimationNodeAnimation" id=7]
animation = "JumpFall"

[sub_resource type="AnimationNodeAnimation" id=8]
animation = "Walk"

[sub_resource type="AnimationNodeAnimation" id=9]
animation = "jump-loop"

[sub_resource type="AnimationNodeAnimation" id=10]
animation = "Jump-move"

[sub_resource type="AnimationNodeTimeScale" id=11]

[sub_resource type="AnimationNodeBlendTree" id=12]
graph_offset = Vector2( 199, -3 )
nodes/Animation/node = SubResource( 10 )
nodes/Animation/position = Vector2( 140, 80 )
nodes/jump-move-speed/node = SubResource( 11 )
nodes/jump-move-speed/position = Vector2( 340, 60 )
nodes/output/position = Vector2( 560, 60 )
node_connections = [ "output", 0, "jump-move-speed", "jump-move-speed", 0, "Animation" ]

[sub_resource type="AnimationNodeStateMachineTransition" id=13]
switch_mode = 2
auto_advance = true
xfade_time = 0.3

[sub_resource type="AnimationNodeStateMachineTransition" id=14]
advance_condition = "c_start_fall"
priority = 0

[sub_resource type="AnimationNodeStateMachineTransition" id=15]
auto_advance = true
xfade_time = 0.3
priority = 0

[sub_resource type="AnimationNodeStateMachineTransition" id=16]
advance_condition = "c_is_grounded"
priority = 0

[sub_resource type="AnimationNodeStateMachineTransition" id=17]
advance_condition = "c_start_fall"

[sub_resource type="AnimationNodeStateMachineTransition" id=18]
advance_condition = "c_is_moving"
xfade_time = 0.3

[sub_resource type="AnimationNodeStateMachineTransition" id=19]
switch_mode = 2
auto_advance = true
xfade_time = 0.2

[sub_resource type="AnimationNodeStateMachine" id=20]
states/Fall/node = SubResource( 2 )
states/Fall/position = Vector2( 574, 91 )
states/FallGround/node = SubResource( 5 )
states/FallGround/position = Vector2( 675, 22 )
states/Jump/node = SubResource( 6 )
states/Jump/position = Vector2( 187, 98 )
states/JumpFall/node = SubResource( 7 )
states/JumpFall/position = Vector2( 498, 155 )
states/Walk/node = SubResource( 8 )
states/Walk/position = Vector2( 768, 171 )
states/jump-loop/node = SubResource( 9 )
states/jump-loop/position = Vector2( 424, 50 )
states/jumpmove/node = SubResource( 12 )
states/jumpmove/position = Vector2( 630, 254 )
transitions = [ "Jump", "jump-loop", SubResource( 13 ), "jump-loop", "JumpFall", SubResource( 14 ), "JumpFall", "Fall", SubResource( 15 ), "Fall", "FallGround", SubResource( 16 ), "Jump", "JumpFall", SubResource( 17 ), "Jump", "jumpmove", SubResource( 18 ), "jumpmove", "Fall", SubResource( 19 ) ]
start_node = "Jump"
end_node = "FallGround"
graph_offset = Vector2( 379, -56 )

[sub_resource type="AnimationNodeAnimation" id=21]
animation = "Walk"

[sub_resource type="AnimationNodeAnimation" id=22]
animation = "Idle"

[sub_resource type="AnimationNodeBlend2" id=23]
filters = [ "Armature/Skeleton:Base.Pole" ]

[sub_resource type="AnimationNodeTimeScale" id=24]

[sub_resource type="AnimationNodeBlendTree" id=25]
graph_offset = Vector2( -26, 75.75 )
nodes/Animation/node = SubResource( 22 )
nodes/Animation/position = Vector2( 0, 100 )
"nodes/Animation 2/node" = SubResource( 21 )
"nodes/Animation 2/position" = Vector2( -140, 240 )
nodes/move/node = SubResource( 23 )
nodes/move/position = Vector2( 220, 140 )
nodes/output/position = Vector2( 420, 140 )
nodes/walk_speed/node = SubResource( 24 )
nodes/walk_speed/position = Vector2( 40, 220 )
node_connections = [ "output", 0, "move", "walk_speed", 0, "Animation 2", "move", 0, "Animation", "move", 1, "walk_speed" ]

[sub_resource type="AnimationNodeAnimation" id=26]
animation = "Twist"

[sub_resource type="AnimationNodeStateMachineTransition" id=27]
advance_condition = "c_jump"

[sub_resource type="AnimationNodeStateMachineTransition" id=28]
switch_mode = 2
auto_advance = true
xfade_time = 0.2

[sub_resource type="AnimationNodeStateMachineTransition" id=29]
advance_condition = "c_attack"
xfade_time = 0.1

[sub_resource type="AnimationNodeStateMachineTransition" id=30]
switch_mode = 2
auto_advance = true

[sub_resource type="AnimationNodeStateMachine" id=31]
states/OnAir/node = SubResource( 20 )
states/OnAir/position = Vector2( 464, 91 )
states/OnGround/node = SubResource( 25 )
states/OnGround/position = Vector2( 268, 56 )
states/Twist/node = SubResource( 26 )
states/Twist/position = Vector2( 294, 151 )
transitions = [ "OnGround", "OnAir", SubResource( 27 ), "OnAir", "OnGround", SubResource( 28 ), "OnGround", "Twist", SubResource( 29 ), "Twist", "OnGround", SubResource( 30 ) ]
start_node = "OnGround"
graph_offset = Vector2( 80, -18 )

[sub_resource type="AnimationNodeStateMachinePlayback" id=32]

[sub_resource type="AnimationNodeStateMachinePlayback" id=33]

[sub_resource type="Skin" id=34]
bind_count = 42
bind/0/bone = 0
bind/0/pose = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -0.846384, 0.123348, 0.800812 )
bind/1/bone = 1
bind/1/pose = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -0.536716, -1.30512, 3.86921 )
bind/2/bone = 2
bind/2/pose = Transform( 0.0698295, -0.159802, 0.984676, 0.916334, 0.400415, -7.45058e-08, -0.394279, 0.902292, 0.174393, 0.709727, -0.72618, 0.584662 )
bind/3/bone = 3
bind/3/pose = Transform( 1, 0, 0, 0, 0, 1, 0, -1, 0, 5.21548, -1.42116, 8.95836 )
bind/4/bone = 4
bind/4/pose = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0.737171, 3.3121, 0.0267697 )
bind/5/bone = 5
bind/5/pose = Transform( -0.89478, 0.000478923, 0.446506, 0.0505669, 0.993674, 0.100268, -0.443634, 0.112297, -0.889144, -0.646067, 3.33111, 0.021102 )
bind/6/bone = 6
bind/6/pose = Transform( -1, 0, 0, 0, 1, 0, 0, 0, -1, -0.800344, 1.35773, 1.618 )
bind/7/bone = 7
bind/7/pose = Transform( 1, 0, 0, 0, 0, 1, 0, -1, 0, 5.61333, -1.49615, 7.69325 )
bind/8/bone = 8
bind/8/pose = Transform( 1, 0, 0, 0, 0, 1, 0, -1, 0, 4.35631, -1.48287, 7.70341 )
bind/9/bone = 9
bind/9/pose = Transform( 1, 0, 0, 0, 0, 1, 0, -1, 0, 5.07831, -1.36056, 5.95037 )
bind/10/bone = 10
bind/10/pose = Transform( 1, 0, 0, 0, 0.186543, 0.982447, 0, -0.982447, 0.186543, 1.57079, 5.85584e-08, 1.11188e-08 )
bind/11/bone = 11
bind/11/pose = Transform( -1, -3.10539e-08, 3.88174e-07, -3.89414e-07, 0.0797452, -0.996815, 1.77636e-14, -0.996815, -0.0797452, -1.57079, -0.269017, 0.981673 )
bind/12/bone = 12
bind/12/pose = Transform( -1, 2.50069e-07, -5.05821e-07, 5.6426e-07, 0.44318, -0.896432, 5.68434e-14, -0.896432, -0.44318, -1.57079, -1.25459, 2.42086 )
bind/13/bone = 13
bind/13/pose = Transform( -0.875262, -0.483647, 1.3262e-06, 0.11931, -0.215913, 0.969095, -0.468701, 0.848213, 0.246685, 1.10098, 0.916375, -2.70233 )
bind/14/bone = 14
bind/14/pose = Transform( 0.0115662, -0.0533533, 0.998508, 0.977299, 0.211862, 4.47034e-07, -0.211547, 0.975841, 0.0545928, 0.783247, -0.801037, -1.12069 )
bind/15/bone = 15
bind/15/pose = Transform( 0.764656, -0.644438, 2.8417e-07, 4.79145e-07, 1.07723e-06, 1, -0.644438, -0.764656, 1.12462e-06, 3.12243, -0.207647, 2.49523 )
bind/16/bone = 16
bind/16/pose = Transform( -2.93863e-07, 2.44854e-07, 1, -0.599041, 0.800718, -3.31638e-07, -0.800718, -0.599041, -8.42142e-08, -0.207644, -3.73544, 2.28162 )
bind/17/bone = 17
bind/17/pose = Transform( -0.875261, 0.483647, -1.13994e-06, -0.11931, -0.215913, 0.969095, 0.468701, 0.848213, 0.246685, -3.84223, 0.542705, -1.23439 )
bind/18/bone = 18
bind/18/pose = Transform( 0.0115662, 0.0533533, -0.998508, -0.977298, 0.211862, 4.78699e-07, 0.211547, 0.975841, 0.054593, -0.747023, -3.86186, -0.458142 )
bind/19/bone = 19
bind/19/pose = Transform( 0.764656, 0.644438, -3.30999e-07, -4.14362e-07, 1.09285e-06, 1, 0.644438, -0.764656, 1.08516e-06, -0.727585, -0.207649, 4.51356 )
bind/20/bone = 20
bind/20/pose = Transform( -3.26232e-07, -2.91776e-07, -1, 0.599041, 0.800718, -3.69567e-07, 0.800718, -0.599041, -8.63364e-08, 0.207643, -1.85929, 4.78941 )
bind/21/bone = 21
bind/21/pose = Transform( 1, 5.28046e-07, 1.15181e-07, 5.40462e-07, -0.977053, -0.212996, 6.59739e-11, 0.212996, -0.977053, 1.57675, 3.39703, 0.712978 )
bind/22/bone = 22
bind/22/pose = Transform( -1, 1.74428e-06, -2.0521e-07, 1.75631e-06, 0.99315, -0.116841, 2.55795e-13, -0.116841, -0.99315, -1.57676, -2.61803, 2.83009 )
bind/23/bone = 23
bind/23/pose = Transform( 1, 2.55922e-09, -6.2975e-08, 6.2975e-08, 5.96046e-08, 1, 2.55925e-09, -1, 5.96046e-08, 1.9698, -1.74849, 3.70562 )
bind/24/bone = 24
bind/24/pose = Transform( 1, -9.68902e-09, -6.58373e-08, 6.58374e-08, 2.98023e-08, 1, -9.68889e-09, -1, 6.37891e-16, 2.10345, -1.41956, 4.29465 )
bind/25/bone = 25
bind/25/pose = Transform( 1, -3.90298e-10, -6.36644e-08, 6.36644e-08, 8.94069e-08, 1, -3.90169e-10, -1, 2.98023e-08, 1.61038, -0.855869, 1.94398 )
bind/26/bone = 26
bind/26/pose = Transform( 1, -1.20559e-08, -6.63905e-08, 6.63904e-08, -1.78814e-07, 1, -1.20559e-08, -1, -1.78814e-07, 1.18264, -1.74849, 3.69734 )
bind/27/bone = 27
bind/27/pose = Transform( 1, -2.24421e-08, -6.88175e-08, 6.88176e-08, -1.54441e-15, 1, -2.24421e-08, -1, -1.19209e-07, 1.25053, -1.02189, 1.59337 )
bind/28/bone = 28
bind/28/pose = Transform( 1, -3.43397e-08, -7.1598e-08, 7.1598e-08, 8.94069e-08, 1, -3.43397e-08, -1, 5.96046e-08, 0.84954, -1.47004, 4.23272 )
bind/29/bone = 29
bind/29/pose = Transform( -0.908958, -0.416724, -0.0116963, -0.125311, 0.246353, 0.961045, -0.397609, 0.875015, -0.276144, -1.28803, -0.19757, -0.271765 )
bind/30/bone = 30
bind/30/pose = Transform( 0.999472, 0.0285113, 0.0155827, 0.00838873, 0.236901, -0.971497, -0.0313902, 0.971115, 0.236537, 0.831631, 0.764818, 1.18713 )
bind/31/bone = 31
bind/31/pose = Transform( -0.908959, 0.416724, 0.0116965, 0.125311, 0.246352, 0.961045, 0.39761, 0.875015, -0.276144, -1.55876, 0.194894, 0.973516 )
bind/32/bone = 32
bind/32/pose = Transform( 0.999473, -0.0285114, -0.0155828, -0.00838929, 0.236901, -0.971498, 0.0313901, 0.971115, 0.236537, 2.29864, 0.738544, 1.28544 )
bind/33/bone = 33
bind/33/pose = Transform( 1, 0, 0, 0, 1, 1.78814e-07, 0, -2.23517e-07, 1, 1.57079, -4.26242, -0.707719 )
bind/34/bone = 34
bind/34/pose = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 2.39475, 3.3121, 0.0267697 )
bind/35/bone = 35
bind/35/pose = Transform( -0.89478, -0.000478856, -0.446507, -0.050567, 0.993675, 0.100268, 0.443634, 0.112297, -0.889144, -2.15631, 3.17274, 1.41053 )
bind/36/bone = 36
bind/36/pose = Transform( -1, 0, 0, 0, 1, 0, 0, 0, -1, -2.33157, 1.35773, 1.618 )
bind/37/bone = 37
bind/37/pose = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 3.9783, 0.123348, 0.800812 )
bind/38/bone = 38
bind/38/pose = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 3.66863, -1.30512, 3.86921 )
bind/39/bone = 39
bind/39/pose = Transform( 0.13762, 0.377415, -0.915761, -0.976153, 0.208391, -0.0608114, 0.167886, 0.902292, 0.397093, -0.139304, -3.90643, 1.09719 )
bind/40/bone = 40
bind/40/pose = Transform( 1, 0, -2.38419e-07, 2.38419e-07, 0, 1, 0, -1, 0, 4.71407, -1.47004, 9.05458 )
bind/41/bone = 41
bind/41/pose = Transform( 1, 0, -2.38419e-07, 2.38419e-07, 0, 1, 2.84217e-14, -1, 1.19209e-07, 4.77381, -1.52657, 5.96868 )

[sub_resource type="BoxShape" id=35]
extents = Vector3( 0.420003, 0.0275754, 0.261477 )

[sub_resource type="BoxShape" id=36]
extents = Vector3( 0.61157, 0.933742, 0.34962 )

[node name="obj_Character" type="KinematicBody" groups=[
"player",
]]
collision_layer = 2
collision_mask = 28
script = ExtResource( 1 )

[node name="CollisionShape" type="CollisionShape" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.74906, 0 )
shape = SubResource( 1 )

[node name="AnimationTree" type="AnimationTree" parent="."]
tree_root = SubResource( 31 )
anim_player = NodePath("../Crash/AnimationPlayer")
active = true
parameters/playback = SubResource( 32 )
parameters/conditions/c_attack = false
parameters/conditions/c_jump = false
parameters/OnAir/playback = SubResource( 33 )
parameters/OnAir/conditions/c_is_grounded = true
parameters/OnAir/conditions/c_is_moving = false
parameters/OnAir/conditions/c_start_fall = true
parameters/OnAir/FallGround/fallground-speed/scale = 1.0
parameters/OnAir/jumpmove/jump-move-speed/scale = 1.0
parameters/OnGround/move/blend_amount = 0.0
parameters/OnGround/walk_speed/scale = 0.0
script = ExtResource( 3 )

[node name="RayCast" type="RayCast" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.0544803 )
enabled = true
cast_to = Vector3( 0, -0.1, 0 )
collision_mask = 281
collide_with_areas = true

[node name="twistcrash" parent="." instance=ExtResource( 9 )]
visible = false

[node name="Crash" parent="." instance=ExtResource( 2 )]

[node name="Crash" parent="Crash/Armature/Skeleton" index="0"]
skin = SubResource( 34 )

[node name="Feet" type="Area" parent="."]
collision_layer = 256
collision_mask = 256

[node name="CollisionShape" type="CollisionShape" parent="Feet"]
shape = SubResource( 35 )

[node name="Body" type="Area" parent="."]
collision_layer = 512
collision_mask = 140

[node name="CollisionShape" type="CollisionShape" parent="Body"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0.0401151, 0.866708, 0.152492 )
shape = SubResource( 36 )

[node name="AkuPos" type="Position3D" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -1.08183, 1.41054, 0 )
[connection signal="area_shape_entered" from="Feet" to="." method="_on_Feet_area_shape_entered"]
[connection signal="area_entered" from="Body" to="." method="_on_Body_area_entered"]

[editable path="twistcrash"]

[editable path="Crash"]
